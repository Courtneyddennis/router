{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/FSA/Phase 2/router/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/User/Desktop/FSA/Phase 2/router/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/User/Desktop/FSA/Phase 2/router/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Update(_ref){var token=_ref.token;var BASE=\"https://strangers-things.herokuapp.com/api/2211-ftb-ct-web-pt\";var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),description=_useState6[0],setDescription=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),price=_useState8[0],setPrice=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),willDeliver=_useState10[0],setWillDeliver=_useState10[1];var navigate=useNavigate();function updatePosts(_x){return _updatePosts.apply(this,arguments);}function _updatePosts(){_updatePosts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var response,result,newPosts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return fetch(\"\".concat(BASE,\"/{postId}\"),{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},method:\"PATCH\",body:JSON.stringify({post:{title:title,description:description,price:price,willDeliver:willDeliver}})});case 4:response=_context.sent;_context.next=7;return response.json();case 7:result=_context.sent;console.log(result);navigate('/Posts',{replace:true});if(result&&result.title){newPosts=posts.map(function(post){if(post.id===postId){return result;}else{return post;}});setPosts(newPosts);setTitle(\"\");setDescription(\"\");setPrice(\"\");setWillDeliver(\"\");setPostId(null);}_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 16:case\"end\":return _context.stop();}},_callee,null,[[1,13]]);}));return _updatePosts.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{children:post.title}),/*#__PURE__*/_jsx(\"div\",{children:post.description}),/*#__PURE__*/_jsx(\"div\",{children:post.price}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return setPostId(post.id);},children:\"Edit\"})]},post._id);}","map":{"version":3,"names":["useState","useEffect","Link","Update","token","BASE","posts","setPosts","title","setTitle","description","setDescription","price","setPrice","willDeliver","setWillDeliver","navigate","useNavigate","updatePosts","event","preventDefault","fetch","headers","method","body","JSON","stringify","post","response","json","result","console","log","replace","newPosts","map","id","postId","setPostId","_id"],"sources":["C:/Users/User/Desktop/FSA/Phase 2/router/src/components/Update.js"],"sourcesContent":["import {useState,useEffect} from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport default function Update({token}){\r\n    const BASE = \"https://strangers-things.herokuapp.com/api/2211-ftb-ct-web-pt\"\r\n    const[posts,setPosts]= useState([])\r\n    const[title,setTitle]=useState(\"\")\r\n    const[description,setDescription]=useState(\"\")\r\n    const[price,setPrice]=useState(\"\")\r\n    const[willDeliver,setWillDeliver]=useState(true)\r\n    const navigate = useNavigate();\r\n\r\n\r\n\r\n    \r\n        async function updatePosts(event){\r\n            event.preventDefault()\r\n             try{\r\n                 const response = await fetch(`${BASE}/{postId}`,{\r\n\r\n                     headers:{\r\n                         'Content-Type': 'application/json',\r\n                            'Authorization': `Bearer ${token}`\r\n                         },\r\n                         method:\"PATCH\",\r\n                         body: JSON.stringify({\r\n                            post: {\r\n                              title: title,\r\n                              description: description,\r\n                              price: price,\r\n                              willDeliver: willDeliver\r\n                            }})\r\n\r\n                    })\r\n\r\n                    let result = await response.json()\r\n                    console.log(result)\r\n                    navigate('/Posts', {replace: true})\r\n                    if(\r\n                        result&&result.title\r\n                    ){const newPosts=posts.map(post=>{\r\n                        if(post.id===postId){\r\n                            return result;\r\n                        }else{\r\n                            return post;\r\n                        }\r\n                    });\r\n                    setPosts(newPosts);\r\n                    setTitle(\"\");\r\n                    setDescription(\"\");\r\n                    setPrice(\"\");\r\n                    setWillDeliver(\"\")\r\n                    setPostId(null);\r\n\r\n                    }\r\n                \r\n             }catch(err){\r\n                 console.log(err)\r\n             }\r\n         }\r\n   \r\n\r\n         return(\r\n            <div key={post._id} className=\"card\">\r\n                <div>{post.title}</div>\r\n                <div>{post.description}</div>\r\n                <div>{post.price}</div>\r\n                <button type=\"button\"\r\n                onClick={()=>setPostId(post.id)}>Edit</button>\r\n                \r\n            </div>\r\n\r\n        )\r\n\r\n\r\n}"],"mappings":"0YAAA,OAAQA,QAAQ,CAACC,SAAS,KAAO,OAAO,CACxC,OAASC,IAAI,KAAQ,kBAAkB,CAAC,wFAExC,cAAe,SAASC,OAAM,MAAS,IAAPC,MAAK,MAALA,KAAK,CACjC,GAAMC,KAAI,CAAG,+DAA+D,CAC5E,cAAuBL,QAAQ,CAAC,EAAE,CAAC,wCAA7BM,KAAK,eAACC,QAAQ,eACpB,eAAsBP,QAAQ,CAAC,EAAE,CAAC,yCAA5BQ,KAAK,eAACC,QAAQ,eACpB,eAAkCT,QAAQ,CAAC,EAAE,CAAC,yCAAxCU,WAAW,eAACC,cAAc,eAChC,eAAsBX,QAAQ,CAAC,EAAE,CAAC,yCAA5BY,KAAK,eAACC,QAAQ,eACpB,eAAkCb,QAAQ,CAAC,IAAI,CAAC,0CAA1Cc,WAAW,gBAACC,cAAc,gBAChC,GAAMC,SAAQ,CAAGC,WAAW,EAAE,CAAC,QAKZC,YAAW,+IAA1B,iBAA2BC,KAAK,gJAC5BA,KAAK,CAACC,cAAc,EAAE,uCAEMC,MAAK,WAAIhB,IAAI,cAAY,CAE5CiB,OAAO,CAAC,CACJ,cAAc,CAAE,kBAAkB,CAC/B,eAAe,kBAAYlB,KAAK,CACnC,CAAC,CACDmB,MAAM,CAAC,OAAO,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAClBC,IAAI,CAAE,CACJnB,KAAK,CAAEA,KAAK,CACZE,WAAW,CAAEA,WAAW,CACxBE,KAAK,CAAEA,KAAK,CACZE,WAAW,CAAEA,WACf,CAAC,CAAC,CAEV,CAAC,CAAC,QAfCc,QAAQ,qCAiBQA,SAAQ,CAACC,IAAI,EAAE,QAA9BC,MAAM,eACVC,OAAO,CAACC,GAAG,CAACF,MAAM,CAAC,CACnBd,QAAQ,CAAC,QAAQ,CAAE,CAACiB,OAAO,CAAE,IAAI,CAAC,CAAC,CACnC,GACIH,MAAM,EAAEA,MAAM,CAACtB,KAAK,CACvB,CAAO0B,QAAQ,CAAC5B,KAAK,CAAC6B,GAAG,CAAC,SAAAR,IAAI,CAAE,CAC7B,GAAGA,IAAI,CAACS,EAAE,GAAGC,MAAM,CAAC,CAChB,MAAOP,OAAM,CACjB,CAAC,IAAI,CACD,MAAOH,KAAI,CACf,CACJ,CAAC,CAAC,CACFpB,QAAQ,CAAC2B,QAAQ,CAAC,CAClBzB,QAAQ,CAAC,EAAE,CAAC,CACZE,cAAc,CAAC,EAAE,CAAC,CAClBE,QAAQ,CAAC,EAAE,CAAC,CACZE,cAAc,CAAC,EAAE,CAAC,CAClBuB,SAAS,CAAC,IAAI,CAAC,CAEf,CAAC,iFAGJP,OAAO,CAACC,GAAG,aAAK,qEAEvB,8CAGD,mBACG,aAAoB,SAAS,CAAC,MAAM,wBAChC,qBAAML,IAAI,CAACnB,KAAK,EAAO,cACvB,qBAAMmB,IAAI,CAACjB,WAAW,EAAO,cAC7B,qBAAMiB,IAAI,CAACf,KAAK,EAAO,cACvB,eAAQ,IAAI,CAAC,QAAQ,CACrB,OAAO,CAAE,yBAAI0B,UAAS,CAACX,IAAI,CAACS,EAAE,CAAC,EAAC,UAAC,MAAI,EAAS,GALxCT,IAAI,CAACY,GAAG,CAOZ,CAKlB"},"metadata":{},"sourceType":"module","externalDependencies":[]}