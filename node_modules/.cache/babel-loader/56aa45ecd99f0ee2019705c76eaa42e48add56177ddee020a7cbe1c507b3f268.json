{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/FSA/Phase 2/router/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/User/Desktop/FSA/Phase 2/router/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/User/Desktop/FSA/Phase 2/router/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Posts(_ref){var token=_ref.token;// return <div>Posts</div>\nvar BASE=\"https://strangers-things.herokuapp.com/api/2211-ftb-ct-web-pt\";var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];useEffect(function(){function getPosts(){return _getPosts.apply(this,arguments);}function _getPosts(){_getPosts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(BASE,\"/posts\"),{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}});case 3:response=_context.sent;_context.next=6;return response.json();case 6:result=_context.sent;console.log(result);setPosts(result.data.posts);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return _getPosts.apply(this,arguments);}getPosts();},[]);function deletePosts(_x){return _deletePosts.apply(this,arguments);}function _deletePosts(){_deletePosts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(postId){var response,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"\".concat(BASE,\"/posts/\").concat(postId),{method:\"DELETE\",headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}});case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:result=_context2.sent;console.log(result);_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 13:case\"end\":return _context2.stop();}},_callee2,null,[[0,10]]);}));return _deletePosts.apply(this,arguments);}function sendMessages(_x2,_x3){return _sendMessages.apply(this,arguments);}function _sendMessages(){_sendMessages=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(event,postId){var response,result;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:event.preventDefault();_context3.prev=1;_context3.next=4;return fetch(\"\".concat(BASE,\"/posts/\").concat(postId,\"/messages\"),{headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},method:\"POST\",body:JSON.stringify({message:{content:messages}})});case 4:response=_context3.sent;_context3.next=7;return response.json();case 7:result=_context3.sent;console.log(result);_context3.next=14;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0);case 14:case\"end\":return _context3.stop();}},_callee3,null,[[1,11]]);}));return _sendMessages.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"CreatePost\",children:\"Create A Listing\"}),/*#__PURE__*/_jsx(_Fragment,{children:posts.map(function(post){return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{children:post.title}),/*#__PURE__*/_jsx(\"div\",{children:post.description}),/*#__PURE__*/_jsx(\"div\",{children:post.price}),!post.isAuthor?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Message:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:messages,onChange:function onChange(event){return setMessages(event.target.value);}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(event){return sendMessages(event,post._id);},children:\"Message\"})]}):/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return deletePosts(post._id);},children:\"Delete\"})]},post._id);})})]});}","map":{"version":3,"names":["useState","useEffect","Link","Posts","token","BASE","posts","setPosts","messages","setMessages","getPosts","fetch","headers","response","json","result","console","log","data","deletePosts","postId","method","sendMessages","event","preventDefault","body","JSON","stringify","message","content","map","post","title","description","price","isAuthor","target","value","_id"],"sources":["C:/Users/User/Desktop/FSA/Phase 2/router/src/components/Posts.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\n\r\n\r\n\r\nexport default function Posts({ token }) {\r\n    // return <div>Posts</div>\r\n    const BASE = \"https://strangers-things.herokuapp.com/api/2211-ftb-ct-web-pt\"\r\n    const [posts, setPosts] = useState([])\r\n    const[messages,setMessages]=useState(\"\")\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        async function getPosts() {\r\n            try {\r\n                const response = await fetch(`${BASE}/posts`, {\r\n\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Authorization': `Bearer ${token}`\r\n                    },\r\n                })\r\n                let result = await response.json()\r\n                console.log(result)\r\n                setPosts(result.data.posts);\r\n\r\n\r\n            } catch (err) {\r\n                console.log(err)\r\n            }\r\n        }\r\n        getPosts()\r\n\r\n    }, [])\r\n\r\n\r\n    async function deletePosts(postId) {\r\n        try {\r\n            const response = await fetch(`${BASE}/posts/${postId}`, {\r\n                method: \"DELETE\",\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            })\r\n            let result = await response.json();\r\n            console.log(result)\r\n\r\n\r\n\r\n\r\n        } catch (err) {\r\n            console.log(err)\r\n        }\r\n    }\r\n\r\n    async function sendMessages(event,postId){\r\n        event.preventDefault()\r\n         try{\r\n             const response = await fetch(`${BASE}/posts/${postId}/messages`,{\r\n\r\n                 headers:{\r\n                     'Content-Type': 'application/json',\r\n                        'Authorization': `Bearer ${token}`\r\n                     },\r\n                     method:\"POST\",\r\n                     body: JSON.stringify({\r\n                        message: {\r\n                          content:messages\r\n                        }\r\n                    })\r\n\r\n                })\r\n\r\n                let result = await response.json()\r\n                console.log(result)\r\n                \r\n            \r\n         }catch(err){\r\n             console.log(err)\r\n         }\r\n     }\r\n\r\n    return (\r\n        <>\r\n\r\n            <Link to=\"CreatePost\">Create A Listing</Link>\r\n            <>\r\n\r\n                {posts.map(post => {\r\n\r\n                    return (\r\n                        <div key={post._id} className=\"card\">\r\n                            <div>{post.title}</div>\r\n                            <div>{post.description}</div>\r\n                            <div>{post.price}</div>\r\n\r\n                            {!post.isAuthor ?\r\n                                <>\r\n                                    <label>Message:</label>\r\n                                    <input type=\"text\" value={messages} onChange=\r\n                                        {(event) => setMessages(event.target.value)}></input>\r\n                                    <button type=\"button\" onClick={(event) => sendMessages(event, post._id)}>Message</button>\r\n                                </>\r\n                                :\r\n\r\n                                <button type=\"button\" onClick={() => deletePosts(post._id)}>Delete</button>\r\n                            }\r\n\r\n\r\n                        </div>\r\n\r\n                    )\r\n                })}\r\n            </>\r\n        </>\r\n    )\r\n\r\n}\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}